(()=>{"use strict";console.log("[DAO Co-Pilot] Background service worker started"),chrome.runtime.onMessage.addListener((o,e,t)=>(console.log("[DAO Co-Pilot] Received message:",o.type),"BACKGROUND_FETCH"===o.type?(async function(o){try{console.log(`[DAO Co-Pilot] Background fetching: ${o.method} ${o.url}`);const e=await fetch(o.url,{method:o.method,headers:o.headers,body:o.body}),t={};let s;e.headers.forEach((o,e)=>{t[e]=o});const r=e.headers.get("content-type");return s=r&&r.includes("application/json")?await e.json():await e.text(),console.log(`[DAO Co-Pilot] Background fetch complete: ${e.status}`),{ok:e.ok,status:e.status,statusText:e.statusText,headers:t,data:s}}catch(o){throw console.error("[DAO Co-Pilot] Background fetch failed:",o),new Error(`Fetch failed: ${o.message}`)}}(o.data).then(t).catch(o=>{console.error("[DAO Co-Pilot] Background fetch error:",o),t({error:o.message,status:500})}),!0):"ANALYZE_PROPOSAL"===o.type?(async function(o){return console.log("[DAO Co-Pilot] Analyzing proposal:",o),{success:!0}}(o.data).then(t).catch(o=>{console.error("[DAO Co-Pilot] Analysis error:",o),t({error:o.message})}),!0):"PAYMENT_REQUIRED"===o.type?(async function(o){return console.log("[DAO Co-Pilot] Processing micropayment:",o),{success:!0,txHash:"0x..."}}(o.data).then(t).catch(o=>{console.error("[DAO Co-Pilot] Payment error:",o),t({error:o.message})}),!0):void 0)),chrome.runtime.onInstalled.addListener(o=>{console.log("[DAO Co-Pilot] Extension installed:",o.reason),"install"===o.reason&&console.log("[DAO Co-Pilot] Welcome to DAO Governance Co-Pilot!")})})();